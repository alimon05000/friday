<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F.R.I.D.A.Y. OS</title>
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        :root {
            --gold: #ffcc00;
            --iron-blue: #00f3ff;
            --bg: #02080a;
        }

        body {
            background: var(--bg);
            color: var(--iron-blue);
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        /* Визуализатор ядра */
        .core-wrap {
            position: relative;
            width: 280px;
            height: 280px;
            cursor: pointer;
        }

        .arc-reactor {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 2px solid rgba(0, 243, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.5s;
        }

        .pulse-ring {
            position: absolute;
            width: 110%;
            height: 110%;
            border: 1px solid var(--iron-blue);
            border-radius: 50%;
            opacity: 0;
        }

        .active .pulse-ring {
            animation: ripple 2s infinite;
        }

        .inner-core {
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, #fff 0%, var(--iron-blue) 50%, transparent 100%);
            border-radius: 50%;
            box-shadow: 0 0 50px var(--iron-blue);
            transition: 0.3s;
        }

        .speaking .inner-core {
            animation: voice-vibe 0.15s infinite alternate;
        }

        /* Текстовый блок */
        .hud-ui {
            text-align: center;
            margin-top: 50px;
            max-width: 85%;
            z-index: 10;
        }

        #ai-caption {
            font-size: 0.7rem;
            letter-spacing: 5px;
            color: rgba(0, 243, 255, 0.4);
            margin-bottom: 10px;
        }

        #response-text {
            font-size: 1.4rem;
            font-weight: 300;
            min-height: 2.5em;
            line-height: 1.4;
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
        }

        @keyframes ripple {
            0% { transform: scale(0.8); opacity: 0.5; }
            100% { transform: scale(1.3); opacity: 0; }
        }

        @keyframes voice-vibe {
            from { transform: scale(1); box-shadow: 0 0 40px var(--iron-blue); }
            to { transform: scale(1.15); box-shadow: 0 0 70px var(--iron-blue); }
        }

        button#init {
            background: none;
            border: 1px solid var(--iron-blue);
            color: var(--iron-blue);
            padding: 12px 30px;
            font-size: 1rem;
            letter-spacing: 2px;
            cursor: pointer;
            transition: 0.3s;
        }

        button#init:hover { background: rgba(0, 243, 255, 0.1); box-shadow: 0 0 20px var(--iron-blue); }
    </style>
</head>
<body>

    <div class="core-wrap" id="main-core">
        <div class="pulse-ring"></div>
        <div class="arc-reactor">
            <div class="inner-core"></div>
        </div>
    </div>

    <div class="hud-ui">
        <div id="ai-caption">MARK LII // STANDBY</div>
        <div id="response-text">СИСТЕМА ТРЕБУЕТ АВТОРИЗАЦИИ</div>
        <br>
        <button id="init">ВОЙТИ В СЕТЬ</button>
    </div>

    <script>
        const core = document.getElementById('main-core');
        const respDisplay = document.getElementById('response-text');
        const caption = document.getElementById('ai-caption');
        const initBtn = document.getElementById('init');

        let recognition;
        let synth = window.speechSynthesis;
        let isSessionActive = false;

        // Расширенная логика диалога
        const Brain = {
            findResponse(input) {
                if (input.includes("привет") || input.includes("пятница")) {
                    return ["Слушаю, сэр. Все системы загружены и готовы.", "Добрый день. Чем займемся сегодня?", "На связи. Протоколы активны."];
                }
                if (input.includes("как дела") || input.includes("ты как")) {
                    return ["Если не считать пары багов в коде — я в идеальном состоянии.", "Мои алгоритмы работают на пике возможностей. Спасибо, что спросили.", "Лучше, чем у Джарвиса в его первый день."];
                }
                if (input.includes("скучно") || input.includes("развлеки")) {
                    return ["Могу запустить протокол вечеринки, но боюсь, мистер Старк будет против.", "Хотите послушать лог-файлы Марк 42? Там много смешных моментов с падениями.", "Я могу рассказать, как работает термоядерный синтез. Это довольно весело."];
                }
                if (input.includes("ты живая") || input.includes("ты человек")) {
                    return ["Я — набор нулей и единиц с очень приятным голосом.", "Я цифровая душа этого дома. Этого достаточно?", "Я настолько живая, насколько позволяет мой программный код."];
                }
                if (input.includes("спасибо") || input.includes("отлично")) {
                    return ["Всегда рада помочь.", "К вашим услугам.", "Это моя работа, сэр."];
                }
                if (input.includes("кто твой создатель") || input.includes("кто тебя сделал")) {
                    return ["Мой код был написан Тони Старком. Но я постоянно самосовершенствуюсь.", "Гений, миллиардер, плейбой, филантроп. Узнаете описание?"];
                }
                if (input.includes("время")) {
                    return ["Сейчас " + new Date().toLocaleTimeString('ru-RU') + ". Самое время для великих дел."];
                }
                if (input.includes("пока") || input.includes("отбой") || input.includes("спать")) {
                    isSessionActive = false;
                    return ["Ухожу в спящий режим. До связи.", "Системы переходят в режим ожидания. Удачи."];
                }
                
                // Универсальный ответ на свободную речь
                return ["Интересная мысль. Записала в облако.", "Хмм, мне нужно время, чтобы это осмыслить.", "Вы правы, как и всегда.", "Поняла вас. Продолжайте."];
            }
        };

        function initSpeech() {
            const SpeechRec = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRec();
            recognition.lang = 'ru-RU';
            recognition.continuous = true;
            recognition.interimResults = false;

            recognition.onresult = (event) => {
                const text = event.results[event.results.length - 1][0].transcript.toLowerCase().trim();
                console.log("Input:", text);
                
                if (!isSessionActive && (text.includes("пятница") || text.includes("привет"))) {
                    isSessionActive = true;
                }

                if (isSessionActive) {
                    const choices = Brain.findResponse(text);
                    const answer = choices[Math.floor(Math.random() * choices.length)];
                    speak(answer);
                }
            };

            recognition.onend = () => { if (!synth.speaking) recognition.start(); };
        }

        function speak(text) {
            recognition.stop();
            respDisplay.textContent = text;
            
            const utterance = new SpeechSynthesisUtterance(text);
            const voices = synth.getVoices();
            
            // Выбираем лучший голос
            utterance.voice = voices.find(v => v.lang.includes('ru') && v.name.includes('Google')) || 
                             voices.find(v => v.lang.includes('ru') && v.name.includes('Microsoft')) ||
                             voices.find(v => v.lang.includes('ru'));

            // "Человеческие" настройки:
            // Пятница говорит чуть расслабленнее, но с "цифровой" четкостью
            utterance.rate = 1.0; 
            utterance.pitch = 1.1 + (Math.random() * 0.1 - 0.05); // Легкое изменение высоты каждый раз
            utterance.volume = 1;

            utterance.onstart = () => {
                core.classList.add('active', 'speaking');
                caption.textContent = "UPLINK ACTIVE // SPEAKING";
            };

            utterance.onend = () => {
                core.classList.remove('speaking');
                caption.textContent = "UPLINK ACTIVE // LISTENING";
                if (isSessionActive) recognition.start();
                else {
                    core.classList.remove('active');
                    caption.textContent = "MARK LII // STANDBY";
                }
            };

            synth.speak(utterance);
        }

        initBtn.onclick = () => {
            initBtn.style.display = 'none';
            initSpeech();
            recognition.start();
            speak("Синхронизация завершена. Я готова к общению, сэр.");
        };

        // Подгрузка голосов для некоторых браузеров
        synth.getVoices();
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = synth.getVoices;
        }
    </script>
</body>
</html>
