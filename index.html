<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F.R.I.D.A.Y. Protocol</title>
    <style>
        :root {
            --cyan: #00f3ff;
            --dark: #020b10;
            --glass: rgba(0, 243, 255, 0.1);
        }

        body {
            background: var(--dark);
            color: var(--cyan);
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background-image: radial-gradient(circle at center, #0a1f29 0%, #020b10 100%);
        }

        /* Голографический интерфейс */
        .hud-container {
            position: relative;
            width: 300px;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ring {
            position: absolute;
            border: 2px solid var(--cyan);
            border-radius: 50%;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 15px var(--cyan), inset 0 0 10px var(--cyan);
        }

        .ring-1 { width: 100%; height: 100%; border-style: double; border-width: 4px; animation: spin 20s linear infinite; opacity: 0.3; }
        .ring-2 { width: 85%; height: 85%; border-style: dashed; animation: spin-rev 15s linear infinite; opacity: 0.5; }
        .ring-3 { 
            width: 60%; height: 60%; 
            background: radial-gradient(circle, var(--cyan) 0%, transparent 70%);
            border: none;
            opacity: 0.2;
        }

        /* Состояние "Говорит" — эффект пульсации звука */
        .speaking .ring-3 {
            animation: pulse-voice 0.2s infinite alternate;
            opacity: 0.8;
        }

        .status-panel {
            margin-top: 40px;
            text-align: center;
            max-width: 80%;
        }

        #cmd-display {
            font-size: 0.8rem;
            letter-spacing: 4px;
            color: rgba(0, 243, 255, 0.4);
            margin-bottom: 10px;
            height: 20px;
        }

        #ai-text {
            font-size: 1.5rem;
            font-weight: 300;
            text-shadow: 0 0 15px var(--cyan);
            min-height: 3em;
        }

        .session-badge {
            display: inline-block;
            padding: 5px 15px;
            border: 1px solid var(--cyan);
            font-size: 0.7rem;
            margin-top: 20px;
            opacity: 0;
            transition: 0.3s;
        }

        .session-active .session-badge { opacity: 1; animation: blink 1s infinite; }

        @keyframes spin { from { transform: rotate(0); } to { transform: rotate(360deg); } }
        @keyframes spin-rev { from { transform: rotate(360deg); } to { transform: rotate(0); } }
        @keyframes pulse-voice { 
            from { transform: scale(1); opacity: 0.4; } 
            to { transform: scale(1.2); opacity: 1; } 
        }
        @keyframes blink { 50% { opacity: 0.3; } }

        button#start-sync {
            background: var(--glass);
            border: 1px solid var(--cyan);
            color: var(--cyan);
            padding: 15px 30px;
            cursor: pointer;
            letter-spacing: 2px;
            backdrop-filter: blur(5px);
        }
    </style>
</head>
<body class="idle">

    <div class="hud-container" id="hud">
        <div class="ring ring-1"></div>
        <div class="ring ring-2"></div>
        <div class="ring ring-3"></div>
    </div>

    <div class="status-panel">
        <div id="cmd-display">SYSTEM STANDBY</div>
        <div id="ai-text">ОЖИДАНИЕ СИНХРОНИЗАЦИИ</div>
        <div class="session-badge">ACTIVE UPLINK</div>
        <br><br>
        <button id="start-sync">ИНИЦИИРОВАТЬ ПЯТНИЦУ</button>
    </div>

    <script>
        const aiText = document.getElementById('ai-text');
        const cmdDisplay = document.getElementById('cmd-display');
        const hud = document.getElementById('hud');
        const startBtn = document.getElementById('start-sync');

        let recognition;
        let synth = window.speechSynthesis;
        let isSessionActive = false;
        let sessionTimer;

        // Логика диалогов (Personality Matrix)
        const Responses = {
            greetings: [
                "К вашим услугам. Чем могу помочь?",
                "Протоколы загружены. Слушаю вас, сэр.",
                "Все системы в норме. Готова к работе.",
                "На связи. Какие будут указания?"
            ],
            status: [
                "Энергопотребление в норме, внешних угроз не обнаружено.",
                "Провожу диагностику... Всё чисто. Мы готовы к вылету.",
                "Все узлы работают стабильно. Рекомендую обновить прошивку сервоприводов."
            ],
            unknown: [
                "Извините, база данных не содержит такой команды. Попробуйте перефразировать.",
                "Не совсем поняла запрос, но я учусь.",
                "Информации недостаточно для выполнения действия."
            ],
            farewell: [
                "Перехожу в фоновый режим. Зовите, если понадоблюсь.",
                "Отключаю активный интерфейс. Хорошего дня.",
                "Поняла. Системы в режиме ожидания."
            ]
        };

        if ('webkitSpeechRecognition' in window) {
            recognition = new webkitSpeechRecognition();
            recognition.continuous = true;
            recognition.interimResults = false;
            recognition.lang = 'ru-RU';

            recognition.onresult = (event) => {
                const text = event.results[event.results.length - 1][0].transcript.toLowerCase().trim();
                cmdDisplay.textContent = `> ${text}`;
                handleLogic(text);
            };

            recognition.onend = () => { if (!synth.speaking) recognition.start(); };
        }

        function handleLogic(input) {
            // Активация по имени
            if (!isSessionActive) {
                if (input.includes("пятница") || input.includes("привет")) {
                    isSessionActive = true;
                    document.body.classList.add('session-active');
                    speak(getRandom(Responses.greetings));
                    startSessionCountdown();
                }
                return;
            }

            // Продлеваем сессию при любой фразе
            startSessionCountdown();

            // Команды
            if (input.includes("статус") || input.includes("системы")) {
                speak(getRandom(Responses.status));
            } else if (input.includes("время")) {
                const time = new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
                speak(`Текущее время ${time}. Расписание на сегодня пусто, сэр.`);
            } else if (input.includes("спасибо") || input.includes("отбой") || input.includes("спи")) {
                isSessionActive = false;
                document.body.classList.remove('session-active');
                speak(getRandom(Responses.farewell));
            } else if (input.includes("кто ты") || input.includes("своё имя")) {
                speak("Я — Пятница. Заменяю Джарвиса, пока он... занят тем, что стал Вижном.");
            } else {
                speak(getRandom(Responses.unknown));
            }
        }

        function startSessionCountdown() {
            clearTimeout(sessionTimer);
            sessionTimer = setTimeout(() => {
                isSessionActive = false;
                document.body.classList.remove('session-active');
                cmdDisplay.textContent = "UPLINK CLOSED";
            }, 12000); // 12 секунд тишины и сессия закроется
        }

        function speak(text) {
            recognition.stop();
            aiText.textContent = text;
            
            const utterance = new SpeechSynthesisUtterance(text);
            const voices = synth.getVoices();
            
            // Пытаемся найти самый качественный русский голос (Premium или Google)
            utterance.voice = voices.find(v => v.lang.includes('ru') && v.name.includes('Google')) || 
                             voices.find(v => v.lang.includes('ru'));

            // "Оживляем" голос:
            // Пятница говорит чуть быстрее обычного человека и с легким холодным оттенком
            utterance.pitch = 1.1; // Выше — женственнее
            utterance.rate = 1.05;  // Чуть быстрее — профессиональнее
            utterance.volume = 1;

            utterance.onstart = () => hud.classList.add('speaking');
            utterance.onend = () => {
                hud.classList.remove('speaking');
                recognition.start();
            };

            synth.speak(utterance);
        }

        function getRandom(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

        startBtn.onclick = () => {
            startBtn.style.display = 'none';
            recognition.start();
            // Разблокировка голоса (пустой звук)
            synth.speak(new SpeechSynthesisUtterance(""));
            aiText.textContent = "СИСТЕМА ГОТОВА. СКАЖИТЕ: ПРИВЕТ, ПЯТНИЦА";
        };
    </script>
</body>
</html>
