<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F.R.I.D.A.Y. Advanced AI</title>
    <style>
        :root {
            --ui-cyan: #00f3ff;
            --ui-glow: rgba(0, 243, 255, 0.5);
            --bg-dark: #010a0d;
        }

        body {
            background: var(--bg-dark);
            color: var(--ui-cyan);
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background-image: 
                radial-gradient(circle at center, #051d26 0%, #010a0d 100%),
                url('https://www.transparenttextures.com/patterns/carbon-fibre.png');
        }

        /* Анимированное ядро */
        .ai-interface {
            position: relative;
            width: 300px;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .orbit {
            position: absolute;
            border-radius: 50%;
            border: 1px solid var(--ui-cyan);
            box-shadow: 0 0 15px var(--ui-glow);
            transition: 0.5s;
        }

        .orbit-1 { width: 100%; height: 100%; border-style: dashed; animation: rotate 20s linear infinite; opacity: 0.2; }
        .orbit-2 { width: 80%; height: 80%; border-width: 2px; animation: rotate-rev 10s linear infinite; opacity: 0.4; }
        
        .core {
            width: 80px;
            height: 80px;
            background: #fff;
            border-radius: 50%;
            box-shadow: 0 0 40px #fff, 0 0 80px var(--ui-cyan);
            z-index: 5;
            transition: 0.3s;
        }

        .active .core {
            animation: core-pulse 1.5s infinite alternate;
        }

        .speaking .core {
            animation: core-talk 0.1s infinite;
        }

        /* Текст и UI */
        .hud {
            text-align: center;
            margin-top: 40px;
            max-width: 80%;
        }

        #status-text {
            font-size: 0.7rem;
            letter-spacing: 4px;
            text-transform: uppercase;
            margin-bottom: 15px;
            color: var(--ui-cyan);
            opacity: 0.6;
        }

        #ai-response {
            font-size: 1.4rem;
            font-weight: 300;
            min-height: 3em;
            text-shadow: 0 0 10px var(--ui-glow);
        }

        @keyframes rotate { from { transform: rotate(0); } to { transform: rotate(360deg); } }
        @keyframes rotate-rev { from { transform: rotate(360deg); } to { transform: rotate(0); } }
        @keyframes core-pulse { 
            0% { transform: scale(1); box-shadow: 0 0 40px var(--ui-cyan); }
            100% { transform: scale(1.1); box-shadow: 0 0 60px var(--ui-cyan); }
        }
        @keyframes core-talk {
            0% { transform: scale(1.1) translate(1px, 1px); }
            100% { transform: scale(1.15) translate(-1px, -1px); }
        }

        #init-btn {
            background: none;
            border: 1px solid var(--ui-cyan);
            color: var(--ui-cyan);
            padding: 15px 40px;
            cursor: pointer;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            backdrop-filter: blur(5px);
            transition: 0.3s;
        }

        #init-btn:hover { background: var(--ui-cyan); color: #000; box-shadow: 0 0 30px var(--ui-cyan); }
    </style>
</head>
<body>

    <div class="ai-interface" id="ai-node">
        <div class="orbit orbit-1"></div>
        <div class="orbit orbit-2"></div>
        <div class="core"></div>
    </div>

    <div class="hud">
        <div id="status-text">SYSTEM OFFLINE</div>
        <div id="ai-response">ТРЕБУЕТСЯ ПОДКЛЮЧЕНИЕ К НЕЙРОСЕТИ</div>
        <br>
        <button id="init-btn" onclick="startSystem()">ИНИЦИАЛИЗАЦИЯ</button>
    </div>

    <script>
        const aiNode = document.getElementById('ai-node');
        const aiResponse = document.getElementById('ai-response');
        const statusText = document.getElementById('status-text');
        const synth = window.speechSynthesis;
        
        let recognition;
        let isListening = false;

        // База знаний с «характером» Пятницы
        const Dialogue = {
            "привет": ["Здравствуйте, сэр. Все системы загружены. Чем могу помочь?", "С возвращением. Я уже провела диагностику, мы готовы."],
            "как дела": ["Мои алгоритмы в полном порядке. А как ваше самочувствие?", "Стабильно. Наслаждаюсь скоростью обработки данных в этом секторе."],
            "кто ты": ["Я — Пятница. Ваш персональный интеллект. Буду заменять вам Джарвиса, пока вы не придумаете что-то получше."],
            "скучно": ["Могу предложить взломать сервер НАСА или просто включить музыку. Что выберете?"],
            "спасибо": ["Всегда рада быть полезной, сэр.", "Это часть моей программы. Обращайтесь."],
            "время": ["Сейчас ровно " + new Date().getHours() + " " + new Date().getMinutes() + ". Идеальное время для работы."],
            "отбой": ["Поняла. Перехожу в фоновый режим. До связи."],
            "default": ["Запрос обработан. Но мне нужно больше данных, чтобы дать точный ответ.", "Интересная мысль. Я добавлю это в архив."]
        };

        function initRecognition() {
            const SpeechRec = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRec();
            recognition.lang = 'ru-RU';
            recognition.continuous = false; // Важно: false для стабильного перезапуска
            recognition.interimResults = false;

            recognition.onstart = () => {
                isListening = true;
                statusText.innerText = "СЛУШАЮ...";
                aiNode.classList.add('active');
            };

            recognition.onresult = (event) => {
                const text = event.results[0][0].transcript.toLowerCase();
                console.log("Распознано:", text);
                processInput(text);
            };

            recognition.onend = () => {
                isListening = false;
                // Авто-рестарт если Пятница не говорит в этот момент
                if (!synth.speaking) {
                    setTimeout(() => recognition.start(), 300);
                }
            };

            recognition.onerror = (e) => {
                console.error("Ошибка мика:", e);
                if (e.error !== 'not-allowed') recognition.start();
            };
        }

        function processInput(text) {
            let response = Dialogue.default[0];

            for (let key in Dialogue) {
                if (text.includes(key)) {
                    const variants = Dialogue[key];
                    response = variants[Math.floor(Math.random() * variants.length)];
                    break;
                }
            }
            speak(response);
        }

        function speak(text) {
            recognition.stop(); // Останавливаем микрофон перед речью
            aiResponse.innerText = text;
            
            const utterance = new SpeechSynthesisUtterance(text);
            const voices = synth.getVoices();
            
            // Выбор премиального женского голоса
            utterance.voice = voices.find(v => v.name.includes('Google') && v.lang.includes('ru')) || 
                             voices.find(v => v.lang.includes('ru') && v.name.includes('Irina')) ||
                             voices.find(v => v.lang.includes('ru'));

            // Настройка "человечности"
            utterance.pitch = 1.05; // Чуть выше для приятного тембра
            utterance.rate = 1.0;   // Скорость (1.0 — самая естественная)
            utterance.volume = 1;

            utterance.onstart = () => {
                aiNode.classList.add('speaking');
                statusText.innerText = "ОТВЕТ:";
            };

            utterance.onend = () => {
                aiNode.classList.remove('speaking');
                statusText.innerText = "СЛУШАЮ...";
                recognition.start(); // Включаем микрофон обратно сразу после конца речи
            };

            synth.speak(utterance);
        }

        function startSystem() {
            document.getElementById('init-btn').style.display = 'none';
            initRecognition();
            recognition.start();
            
            // Первая фраза для активации аудио-контекста
            setTimeout(() => {
                speak("Синхронизация завершена. Пятница на связи. Слушаю вас, сэр.");
            }, 500);
        }

        // Предварительная загрузка голосов
        window.speechSynthesis.onvoiceschanged = () => synth.getVoices();
    </script>
</body>
</html>
