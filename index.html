<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F.R.I.D.A.Y. AI</title>
    <style>
        :root {
            --primary: #00f3ff; /* Основной неон */
            --secondary: #004d52; /* Тусклый неон */
            --bg: #050505;
            --alert: #ff003c;
            --font: 'Segoe UI', 'Courier New', monospace;
        }

        body {
            background-color: var(--bg);
            color: var(--primary);
            font-family: var(--font);
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            text-transform: uppercase;
        }

        /* --- ФОНОВАЯ СЕТКА --- */
        body::before {
            content: "";
            position: absolute;
            width: 200%;
            height: 200%;
            background: 
                linear-gradient(rgba(0, 243, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 243, 255, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            transform: perspective(500px) rotateX(60deg) translateY(-100px) translateZ(-200px);
            animation: grid-move 20s linear infinite;
            z-index: -1;
        }

        @keyframes grid-move {
            0% { transform: perspective(500px) rotateX(60deg) translateY(0) translateZ(-200px); }
            100% { transform: perspective(500px) rotateX(60deg) translateY(50px) translateZ(-200px); }
        }

        /* --- ЯДРО ИНТЕРФЕЙСА (РЕАКТОР) --- */
        .core-container {
            position: relative;
            width: 200px;
            height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 40px;
        }

        .arc-circle {
            position: absolute;
            border-radius: 50%;
            border: 2px solid var(--primary);
            box-shadow: 0 0 20px var(--primary), inset 0 0 20px var(--primary);
            transition: 0.3s ease;
        }

        .c1 { width: 100%; height: 100%; border: 1px dashed var(--secondary); animation: spin 20s linear infinite; }
        .c2 { width: 80%; height: 80%; border: 4px solid var(--primary); border-top-color: transparent; border-bottom-color: transparent; animation: spin-rev 5s linear infinite; }
        .c3 { width: 60%; height: 60%; background: radial-gradient(circle, #fff, var(--primary) 60%, transparent 80%); opacity: 0.8; box-shadow: 0 0 50px var(--primary); }

        /* Состояния анимации */
        .state-listening .c3 {
            animation: pulse 2s infinite ease-in-out;
            background: radial-gradient(circle, #fff, var(--primary) 70%, transparent 90%);
        }

        .state-speaking .c2 {
            animation: spin 0.5s linear infinite;
            border-color: var(--primary);
            box-shadow: 0 0 40px var(--primary);
        }
        .state-speaking .c3 {
            transform: scale(1.1);
            background: radial-gradient(circle, #fff, #aaffff 50%, var(--primary) 90%);
        }

        /* --- ТЕКСТОВЫЙ ИНТЕРФЕЙС --- */
        .ui-panel {
            width: 80%;
            max-width: 600px;
            text-align: center;
            z-index: 10;
        }

        .status-bar {
            font-size: 0.8rem;
            letter-spacing: 3px;
            color: var(--secondary);
            margin-bottom: 10px;
            border-bottom: 1px solid var(--secondary);
            padding-bottom: 5px;
        }

        .transcript-box {
            font-size: 1.2rem;
            min-height: 1.5em;
            color: #fff;
            margin-bottom: 20px;
            text-shadow: 0 0 5px var(--primary);
        }

        .response-box {
            font-size: 1.1rem;
            color: var(--primary);
            min-height: 1.5em;
            margin-bottom: 30px;
            font-weight: bold;
        }

        /* --- КНОПКА ЗАПУСКА --- */
        #init-btn {
            background: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
            padding: 10px 30px;
            font-family: var(--font);
            cursor: pointer;
            transition: 0.3s;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        #init-btn:hover {
            background: var(--primary);
            color: #000;
            box-shadow: 0 0 20px var(--primary);
        }

        /* --- АНИМАЦИИ --- */
        @keyframes spin { 100% { transform: rotate(360deg); } }
        @keyframes spin-rev { 100% { transform: rotate(-360deg); } }
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 0.7; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.7; }
        }

    </style>
</head>
<body>

    <div class="core-container" id="core">
        <div class="arc-circle c1"></div>
        <div class="arc-circle c2"></div>
        <div class="arc-circle c3"></div>
    </div>

    <div class="ui-panel">
        <div class="status-bar" id="status">SYSTEM OFFLINE</div>
        
        <div class="transcript-box" id="user-text">...</div>
        <div class="response-box" id="ai-text"></div>

        <button id="init-btn">INIT SYSTEM</button>
    </div>

    <script>
        // --- ПЕРЕМЕННЫЕ ---
        const core = document.getElementById('core');
        const statusEl = document.getElementById('status');
        const userTextEl = document.getElementById('user-text');
        const aiTextEl = document.getElementById('ai-text');
        const initBtn = document.getElementById('init-btn');

        // Web Speech API
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const synth = window.speechSynthesis;
        let recognition;
        let isSpeaking = false;

        // Имя для активации
        const WAKE_WORD = "пятница";

        // --- НАСТРОЙКА РАСПОЗНАВАНИЯ ---
        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.lang = 'ru-RU';
            recognition.continuous = false; // Перезапускаем вручную для стабильности
            recognition.interimResults = false;

            recognition.onstart = () => {
                if (!isSpeaking) {
                    statusEl.textContent = "LISTENING // WAITING FOR 'FRIDAY'";
                    core.classList.remove('state-speaking');
                    core.classList.add('state-listening');
                }
            };

            recognition.onend = () => {
                // Если мы не говорим, перезапускаем микрофон (бесконечный цикл)
                if (!isSpeaking) {
                    recognition.start();
                }
            };

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript.toLowerCase().trim();
                console.log("Heard:", transcript);

                // Логика фильтрации: реагируем только если есть "Пятница"
                if (transcript.includes(WAKE_WORD)) {
                    userTextEl.textContent = `"${transcript}"`;
                    processCommand(transcript);
                } else {
                    // Игнорируем шумы и другие разговоры
                    userTextEl.textContent = "Ignored: " + transcript;
                }
            };
        } else {
            alert("Ваш браузер не поддерживает Web Speech API. Используйте Chrome.");
        }

        // --- ЛОГИКА (МОЗГ) ---
        function processCommand(fullText) {
            // Убираем слово "пятница" из команды для анализа
            const command = fullText.replace(WAKE_WORD, '').trim(); 
            
            let response = "";

            if (command === "" || command === "." || command === "!") {
                // Если сказали только "Пятница"
                const greetings = ["Слушаю.", "На связи.", "Да, босс?", "Системы готовы."];
                response = greetings[Math.floor(Math.random() * greetings.length)];
            } 
            else if (command.includes("привет") || command.includes("здравствуй")) {
                response = "Здравствуйте. Все системы функционируют в штатном режиме.";
            } 
            else if (command.includes("как дела") || command.includes("статус")) {
                response = "Заряд батареи 100%. Сетевое соединение стабильно. Готова к работе.";
            }
            else if (command.includes("что ты умеешь") || command.includes("функции")) {
                response = "Я управляю интерфейсом, отслеживаю голосовые команды и могу поддержать беседу.";
            }
            else if (command.includes("время") || command.includes("который час")) {
                const now = new Date();
                response = "Текущее время: " + now.getHours() + " часов " + now.getMinutes() + " минут.";
            }
            else if (command.includes("отбой") || command.includes("хватит")) {
                response = "Перехожу в спящий режим.";
            }
            else {
                response = "Команда не распознана, но я записала её в лог.";
            }

            speak(response);
        }

        // --- СИНТЕЗ РЕЧИ ---
        function speak(text) {
            if (!text) return;

            // 1. Остановить прослушку, чтобы не слышать саму себя
            isSpeaking = true;
            recognition.stop(); 
            
            // 2. Визуализация
            statusEl.textContent = "PROCESSING RESPONSE...";
            aiTextEl.textContent = text; // Мгновенный вывод текста
            core.classList.remove('state-listening');
            core.classList.add('state-speaking');

            // 3. Подготовка голоса
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'ru-RU';
            utterance.rate = 1.1; // Чуть быстрее
            utterance.pitch = 0.9; // Чуть ниже (серьезнее)

            // Выбор голоса (приоритет Google Russian)
            const voices = synth.getVoices();
            const ruVoice = voices.find(v => v.lang.includes('ru') && v.name.includes('Google'));
            if (ruVoice) utterance.voice = ruVoice;

            // 4. Событие окончания речи
            utterance.onend = () => {
                isSpeaking = false;
                statusEl.textContent = "SYSTEM STANDBY";
                core.classList.remove('state-speaking');
                // Снова запускаем микрофон
                recognition.start();
            };

            synth.speak(utterance);
        }

        // --- ЗАПУСК ---
        initBtn.addEventListener('click', () => {
            initBtn.style.display = 'none'; // Скрываем кнопку
            // Подгружаем голоса (иногда они грузятся асинхронно)
            synth.getVoices();
            
            // Приветствие при старте
            speak("Протокол 'Пятница' инициирован. Ожидаю команд.");
        });

    </script>
</body>
</html>
